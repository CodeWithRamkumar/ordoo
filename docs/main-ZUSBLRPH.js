import{a as ve}from"./chunk-SWOAIQMG.js";import{a as ie,b as ne,h as re,i as ae}from"./chunk-52PERYBO.js";import"./chunk-G254VQN3.js";import{a as te,b as v}from"./chunk-4HVVZ7VC.js";import{a as oe,b as he}from"./chunk-YBODFWNC.js";import{$a as L,Fc as le,Gb as G,Hb as H,Jb as F,Kb as N,N as m,Pa as A,Pb as B,Pc as me,Q as u,Qb as K,Ra as E,Rb as Q,S as w,Sa as T,Sb as W,Ta as z,Tb as $,Tc as pe,Ub as J,Vb as V,Wa as D,Ya as U,Za as j,_a as R,ac as X,bc as Y,ca as k,da as r,ea as s,ec as Z,fa as l,fc as q,fd as ue,gc as ee,hd as de,j as b,k as C,ka as d,ld as fe,mc as se,n as y,o as x,pd as ge,rc as ce,s as S,tb as _,ua as h,v as O,w as g,wa as p,xa as M,y as I}from"./chunk-TS35J3DX.js";import"./chunk-LVT7LAFM.js";import"./chunk-QUJFQN2Y.js";import"./chunk-OSWHOA5B.js";import"./chunk-NMFGAPTO.js";import"./chunk-D7K6MB32.js";import"./chunk-TL5KAYV2.js";import"./chunk-AGPRGGHL.js";import"./chunk-7CKTJNM7.js";import"./chunk-KNGCU3N4.js";import"./chunk-3COQWRSL.js";import"./chunk-FJEPPHGG.js";import"./chunk-JLVFVAKY.js";import"./chunk-6OS5WUMZ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-XKPZ2LXV.js";import"./chunk-CKP3SGE2.js";import"./chunk-M6BWGQD5.js";import"./chunk-XTA6VOZK.js";import"./chunk-ALL2FOAL.js";import"./chunk-7HDUECN2.js";import"./chunk-I3XFR2VW.js";import"./chunk-J7JKH43X.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{i as a}from"./chunk-VBFW7A5V.js";var we=(()=>{let t=class t{constructor(e){this.toastController=e}showError(e){return a(this,null,function*(){(yield this.toastController.create({message:e,duration:3e3,color:"danger",position:"top"})).present()})}showSuccess(e){return a(this,null,function*(){(yield this.toastController.create({message:e,duration:2e3,color:"success",position:"top"})).present()})}};t.\u0275fac=function(i){return new(i||t)(O(q))},t.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var _e=(o,t)=>{let f=g(we),e=g(v);return b(e.getToken()).pipe(x(i=>(i&&(o=o.clone({setHeaders:{Authorization:`Bearer ${i}`}})),t(o).pipe(y(n=>{if(o.url.includes("/auth/login")||o.url.includes("/auth/signup"))return C(()=>n);if(n.status===401)return e.clearUserData(),f.showError("Session expired. Please login again."),C(()=>new Error("Session expired"));let c="An error occurred";return n.error?.message?c=n.error.message:n.message&&(c=n.message),f.showError(c),C(()=>new Error(c))})))))};var Pe={apiKey:"AIzaSyC3ALxhHriAWiAMK-Db0-s4r-sHqBlvGLc",authDomain:"ordoo-e4361.firebaseapp.com",projectId:"ordoo-e4361",storageBucket:"ordoo-e4361.firebasestorage.app",messagingSenderId:"225556599172",appId:"1:225556599172:web:a72ee75a88db1627f7cdd1",measurementId:"G-9GQSRHTS0H"};var P=(o,t)=>a(null,null,function*(){let f=g(_),e=g(v);try{yield e.init();let i=yield e.getToken();return console.log("Auth Guard - Token:",!!i,"URL:",t.url),t.url.includes("/auth/login")||t.url.includes("/auth/signup")||t.url.includes("/auth/forgot-password")||t.url.includes("/auth/reset-password")?i&&(t.url.includes("/auth/login")||t.url.includes("/auth/signup"))?(console.log("Auth Guard - Redirecting authenticated user to workspace"),f.navigateRoot("/workspace"),!1):!0:i?(console.log("Auth Guard - User authenticated, allowing access"),!0):(console.log("Auth Guard - No token, redirecting to login"),f.navigateRoot("/auth/login"),!1)}catch(i){return console.error("Auth Guard - Error:",i),f.navigateRoot("/auth/login"),!1}});var Me=[{path:"",redirectTo:"auth/login",pathMatch:"full"},{path:"auth",canActivate:[P],loadChildren:()=>import("./chunk-YG35ZM5D.js").then(o=>o.routes)},{path:"workspace",canActivate:[P],loadChildren:()=>import("./chunk-BUS6QEZV.js").then(o=>o.routes)},{path:"profile",canActivate:[P],loadChildren:()=>import("./chunk-2NRBORA3.js").then(o=>o.routes)}];var be=(()=>{let t=class t{constructor(e,i,n,c,xe,Se,Oe){this.menuCtrl=e,this.navCtrl=i,this.authService=n,this.logoutService=c,this.http=xe,this.config=Se,this.loader=Oe,this.userProfile={name:"Loading...",email:"Loading...",image:"assets/icon/ordoo-logo.svg"},this.showCopied=!1,se({home:me,person:ue,search:fe,logOut:pe,calculator:ce,copy:le,personSharp:de,time:ge})}ngOnInit(){return a(this,null,function*(){yield this.authService.init(),yield this.loadUserProfile(),this.userDataSubscription=this.authService.userDataChanged.subscribe(()=>{this.loadUserProfile()})})}ngOnDestroy(){this.userDataSubscription&&this.userDataSubscription.unsubscribe()}loadUserProfile(){return a(this,null,function*(){try{yield this.authService.init();let e=yield this.authService.getUserData();console.log("Menu - User data:",e),e&&e.user?(this.userProfile={name:e.profile?.full_name||e.user.email||"User",email:e.user.email||"No email",image:e.profile?.avatar_url||"assets/icon/default-avatar.svg"},console.log("Menu - Updated profile:",this.userProfile)):(console.log("Menu - No user data found, using defaults"),this.userProfile={name:"Guest User",email:"guest@example.com",image:"assets/icon/ordoo-logo.svg"})}catch(e){console.error("Menu - Error loading user profile:",e),this.userProfile={name:"Error Loading",email:"error@example.com",image:"assets/icon/ordoo-logo.svg"}}})}updateUserProfile(){return a(this,null,function*(){yield this.loadUserProfile()})}copyEmail(){return a(this,null,function*(){try{yield navigator.clipboard.writeText(this.userProfile.email),this.showCopied=!0,setTimeout(()=>this.showCopied=!1,2e3)}catch(e){console.error("Failed to copy email:",e)}})}closeMenu(){this.menuCtrl.close("main-menu")}logout(){return a(this,null,function*(){this.closeMenu(),yield this.logoutService.logout()})}navigateTo(e){this.navCtrl.navigateRoot(e),this.closeMenu()}isActive(e){return(window.location.hash.replace("#","")||window.location.pathname)===e}};t.\u0275fac=function(i){return new(i||t)(u(Z),u(_),u(v),u(ve),u(E),u(oe),u(he))},t.\u0275cmp=w({type:t,selectors:[["app-menu"]],decls:39,vars:13,consts:[["contentId","main-content","menuId","main-menu","side","end"],[1,"menu-header"],[1,"profile-section"],[1,"profile-avatar"],["alt","User Profile",3,"src"],[1,"profile-info"],[1,"profile-name"],[1,"email-container"],[1,"profile-email"],[1,"copy-container"],["name","copy",1,"copy-icon",3,"click"],[1,"copy-tooltip"],[1,"menu-content"],["lines","none"],["button","","detail","false",1,"menu-item",3,"click"],["name","person","slot","start",1,"menu-icon"],[1,"menu-label"],["name","home","slot","start",1,"menu-icon"],["name","calculator","slot","start",1,"menu-icon"],["name","time","slot","start",1,"menu-icon"],[1,"menu-divider"],["name","log-out","slot","start",1,"menu-icon"]],template:function(i,n){i&1&&(r(0,"ion-menu",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"div",2)(4,"ion-avatar",3),l(5,"ion-img",4),s(),r(6,"div",5)(7,"h2",6),p(8),s(),r(9,"div",7)(10,"p",8),p(11),s(),r(12,"div",9)(13,"ion-icon",10),d("click",function(){return n.copyEmail()}),s(),r(14,"span",11),p(15,"Copied!"),s()()()()()()(),r(16,"ion-content",12)(17,"ion-list",13)(18,"ion-item",14),d("click",function(){return n.navigateTo("/profile")}),l(19,"ion-icon",15),r(20,"ion-label",16),p(21,"Profile"),s()(),r(22,"ion-item",14),d("click",function(){return n.navigateTo("/workspace")}),l(23,"ion-icon",17),r(24,"ion-label",16),p(25,"Home"),s()(),r(26,"ion-item",14),d("click",function(){return n.navigateTo("/workspace/calculator-dashboard")}),l(27,"ion-icon",18),r(28,"ion-label",16),p(29,"Calculator"),s()(),r(30,"ion-item",14),d("click",function(){return n.navigateTo("/workspace/clock")}),l(31,"ion-icon",19),r(32,"ion-label",16),p(33,"Clock"),s()(),l(34,"div",20),r(35,"ion-item",14),d("click",function(){return n.logout()}),l(36,"ion-icon",21),r(37,"ion-label",16),p(38,"Logout"),s()()()()()),i&2&&(m(5),k("src",n.userProfile.image),m(3),M(n.userProfile.name),m(3),M(n.userProfile.email),m(3),h("show",n.showCopied),m(4),h("active-item",n.isActive("/profile")),m(4),h("active-item",n.isActive("/workspace")),m(4),h("active-item",n.isActive("/workspace/calculator-dashboard")),m(4),h("active-item",n.isActive("/workspace/clock")))},dependencies:[Q,N,V,K,X,B,J,W,ee,$],styles:["ion-menu[_ngcontent-%COMP%]{--width: 100%;--max-width: 350px}.menu-header[_ngcontent-%COMP%]{--background: var(--ion-color-primary);padding:var(--spacing-md) 0}.menu-header[_ngcontent-%COMP%]   .profile-section[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--spacing-md);gap:var(--spacing-md)}.menu-header[_ngcontent-%COMP%]   .profile-section[_ngcontent-%COMP%]   .profile-avatar[_ngcontent-%COMP%]{background-color:var(--ion-white-color-background);width:64px;height:64px;border:2px solid var(--ion-white-color-text)}.profile-info[_ngcontent-%COMP%]{flex:1;overflow:hidden}.profile-info[_ngcontent-%COMP%]   .profile-name[_ngcontent-%COMP%]{margin:0;font-size:var(--font-size-lg);font-weight:var(--font-weight-bold);color:var(--ion-white-color-text);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.profile-info[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:4px;min-width:0}.profile-info[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]   .profile-email[_ngcontent-%COMP%]{margin:0;font-size:var(--font-size-sm);color:var(--ion-white-color-text);text-overflow:ellipsis;overflow:hidden;white-space:nowrap;min-width:0}.profile-info[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]   .copy-icon[_ngcontent-%COMP%]{font-size:var(--font-size-base);color:var(--ion-white-color-text);cursor:pointer;flex-shrink:0}.profile-info[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]   .copy-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.profile-info[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]   .copy-tooltip[_ngcontent-%COMP%]{position:absolute;top:-30px;left:50%;transform:translate(-50%);background:#000c;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;white-space:nowrap;opacity:0;visibility:hidden;transition:opacity .3s,visibility .3s;z-index:1000}.profile-info[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]   .copy-tooltip.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}.menu-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:8px}.menu-list[_ngcontent-%COMP%]{padding:16px 8px}.menu-item[_ngcontent-%COMP%]{margin:8px 0;border-radius:8px;font-weight:var(--font-weight-medium)}.menu-icon[_ngcontent-%COMP%]{font-size:var(--font-size-3xl);margin-right:16px;color:var(--ion-text-color)}.menu-label[_ngcontent-%COMP%]{font-size:var(--font-size-base);font-weight:var(--font-weight-semibold)}.active-item[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-white-color-text)}.active-item[_ngcontent-%COMP%]   .menu-icon[_ngcontent-%COMP%], .active-item[_ngcontent-%COMP%]   .menu-label[_ngcontent-%COMP%]{color:var(--ion-white-color-text)}.menu-divider[_ngcontent-%COMP%]{height:1px;opacity:.3;background-color:var(--ion-text-color)}"]});let o=t;return o})();var ye=(()=>{let t=class t{constructor(){}ngOnInit(){return a(this,null,function*(){})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=w({type:t,selectors:[["app-root"]],decls:3,vars:0,consts:[["id","main-content"]],template:function(i,n){i&1&&(r(0,"ion-app"),l(1,"app-menu")(2,"ion-router-outlet",0),s())},dependencies:[F,H,be],encapsulation:2});let o=t;return o})();A(ye,{providers:[{provide:D,useClass:G},Y(),j(Me,R(U),L()),T(z([_e])),I(te.forRoot()),ie(()=>ne(Pe)),re(()=>ae())]});
