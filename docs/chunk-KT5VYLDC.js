import{a as ae}from"./chunk-A4U7FTRT.js";import{$b as B,$c as X,Aa as p,I as _,Ic as R,J as f,Ma as T,Oa as m,Ob as N,Od as ee,Pa as h,Qa as E,Qb as W,Rd as te,Sa as y,Ta as w,Tc as U,Ua as M,Ub as V,Uc as q,Vb as $,Wb as F,Wc as J,Y as d,Yc as G,Zc as K,_c as Q,ae as ie,ca as I,ea as z,ee as ne,jd as Y,ma as k,na as O,nd as Z,oa as S,pa as v,qa as b,ra as C,sa as n,ta as o,ua as P,uc as L,vb as H,ya as A,yc as j,za as u}from"./chunk-AILMIR6F.js";import"./chunk-TL5KAYV2.js";import"./chunk-XTA6VOZK.js";import"./chunk-ALL2FOAL.js";import"./chunk-7HDUECN2.js";import"./chunk-I3XFR2VW.js";import"./chunk-J7JKH43X.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as x,b as D}from"./chunk-VBFW7A5V.js";var le=(a,s)=>s.key,se=(a,s)=>s.value,ce=(a,s)=>s.id;function de(a,s){if(a&1&&(n(0,"option",11),m(1),o()),a&2){let r=s.$implicit;C("value",r),d(),h(r)}}function me(a,s){if(a&1&&(n(0,"option",11),m(1),o()),a&2){let r=s.$implicit;C("value",r),d(),h(r)}}function ge(a,s){if(a&1){let r=A();n(0,"button",24),u("click",function(){let i=_(r).$implicit,t=p();return f(t.toggleRepeatDay(i.key))}),m(1),o()}if(a&2){let r=s.$implicit,e=p();T("active",e.isDaySelected(r.key)),d(),E(" ",r.label," ")}}function ue(a,s){if(a&1&&(n(0,"ion-select-option",11),m(1),o()),a&2){let r=s.$implicit;C("value",r.value),d(),h(r.label)}}function pe(a,s){if(a&1){let r=A();n(0,"ion-button",25),u("click",function(){_(r);let i=p();return f(i.cancelEdit())}),m(1," Cancel "),o()}}function he(a,s){a&1&&(n(0,"div",22),P(1,"ion-icon",26),n(2,"p"),m(3,"No alarms created yet"),o()())}function _e(a,s){if(a&1){let r=A();n(0,"div",28)(1,"div",29)(2,"div",30),m(3),o(),n(4,"div",31)(5,"div",32),m(6),o(),n(7,"div",33),m(8),o()()(),n(9,"div",34)(10,"ion-toggle",35),u("ionChange",function(){let i=_(r).$implicit,t=p(2);return f(t.toggleAlarm(i))}),o(),n(11,"ion-button",36),u("click",function(){let i=_(r).$implicit,t=p(2);return f(t.editAlarm(i))}),P(12,"ion-icon",37),o(),n(13,"ion-button",38),u("click",function(){let i=_(r).$implicit,t=p(2);return f(t.deleteAlarm(i.id))}),P(14,"ion-icon",39),o()()()}if(a&2){let r=s.$implicit,e=p(2);T("inactive",!r.isActive),d(3),h(e.formatTime12Hour(r.time)),d(3),h(r.label),d(2),h(e.getRepeatText(r)),d(2),C("checked",r.isActive)}}function fe(a,s){if(a&1&&(n(0,"div",23),v(1,_e,15,6,"div",27,ce),o()),a&2){let r=p();d(),b(r.alarms)}}var Ae=(()=>{let s=class s{constructor(e){this.headerService=e,this.alarms=[],this.showTimePicker=!1,this.selectedHour="07",this.selectedMinute="00",this.selectedPeriod="AM",this.hours=["01","02","03","04","05","06","07","08","09","10","11","12"],this.minutes=Array.from({length:60},(i,t)=>t.toString().padStart(2,"0")),this.editingAlarm=null,this.newAlarm={id:"",time:"07:00",label:"Alarm",isActive:!0,repeatDays:[],sound:"default"},this.weekDays=[{key:"mon",label:"Mon"},{key:"tue",label:"Tue"},{key:"wed",label:"Wed"},{key:"thu",label:"Thu"},{key:"fri",label:"Fri"},{key:"sat",label:"Sat"},{key:"sun",label:"Sun"}],this.sounds=[{value:"default",label:"Default"},{value:"gentle",label:"Gentle"},{value:"classic",label:"Classic"},{value:"digital",label:"Digital"}],this.alarmTimeouts=new Map,this.audio=null,K({add:Q,alarm:X,trash:ne,pencil:te,checkmark:Y,close:Z,time:ie,notifications:ee}),this.loadAlarms()}ngOnInit(){this.headerService.updateHeaderData({title:"Alarm",subtitle:"Set and manage alarms",image:"alarm",imageType:"icon",showBack:!0,showMenu:!0,backNavigationUrl:"/workspace/clock"})}ngOnDestroy(){this.clearAllTimeouts(),this.audio&&(this.audio.pause(),this.audio=null)}formatTime12Hour(e){let[i,t]=e.split(":"),c=parseInt(i),l=c===0?12:c>12?c-12:c,g=c>=12?"PM":"AM";return`${l.toString().padStart(2,"0")}:${t} ${g}`}confirmTime(){let e=this.selectedPeriod==="AM"?this.selectedHour==="12"?"00":this.selectedHour:this.selectedHour==="12"?"12":(parseInt(this.selectedHour)+12).toString().padStart(2,"0");this.newAlarm.time=`${e}:${this.selectedMinute}`,this.showTimePicker=!1}updateTime(){let e=this.selectedPeriod==="AM"?this.selectedHour==="12"?"00":this.selectedHour:this.selectedHour==="12"?"12":(parseInt(this.selectedHour)+12).toString().padStart(2,"0");this.newAlarm.time=`${e}:${this.selectedMinute}`}cancelEdit(){this.editingAlarm=null,this.resetNewAlarm()}editAlarm(e){this.editingAlarm=e,this.newAlarm=x({},e);let[i,t]=e.time.split(":"),c=parseInt(i),l=c===0?12:c>12?c-12:c,g=c>=12?"PM":"AM";this.selectedHour=l.toString().padStart(2,"0"),this.selectedMinute=t,this.selectedPeriod=g}saveAlarm(){if(this.editingAlarm){let e=this.alarms.findIndex(i=>i.id===this.editingAlarm.id);e!==-1&&(this.alarms[e]=x({},this.newAlarm),this.scheduleAlarm(this.alarms[e]))}else{let e=D(x({},this.newAlarm),{id:Date.now().toString()});this.alarms.push(e),this.scheduleAlarm(e)}this.saveAlarms(),this.cancelEdit()}deleteAlarm(e){this.clearTimeout(e),this.alarms=this.alarms.filter(i=>i.id!==e),this.saveAlarms()}toggleAlarm(e){e.isActive=!e.isActive,e.isActive?this.scheduleAlarm(e):this.clearTimeout(e.id),this.saveAlarms(),this.alarms=[...this.alarms]}toggleRepeatDay(e){let i=this.newAlarm.repeatDays.indexOf(e);i>-1?this.newAlarm.repeatDays.splice(i,1):this.newAlarm.repeatDays.push(e)}isDaySelected(e){return this.newAlarm.repeatDays.includes(e)}getRepeatText(e){return e.repeatDays.length===0?"Once":e.repeatDays.length===7?"Every day":e.repeatDays.length===5&&["mon","tue","wed","thu","fri"].every(i=>e.repeatDays.includes(i))?"Weekdays":e.repeatDays.map(i=>this.weekDays.find(t=>t.key===i)?.label).join(", ")}scheduleAlarm(e){if(!e.isActive)return;this.clearTimeout(e.id);let i=new Date,[t,c]=e.time.split(":").map(Number),l=()=>{let g=new Date;if(g.setHours(t,c,0,0),g<=i&&g.setDate(g.getDate()+1),e.repeatDays.length>0)for(;!this.shouldAlarmRing(g,e.repeatDays);)g.setDate(g.getDate()+1);let oe=g.getTime()-i.getTime(),re=setTimeout(()=>{this.triggerAlarm(e),e.repeatDays.length>0&&l()},oe);this.alarmTimeouts.set(e.id,re)};l()}shouldAlarmRing(e,i){let c=["sun","mon","tue","wed","thu","fri","sat"][e.getDay()];return i.includes(c)}triggerAlarm(e){this.playAlarmSound(),"Notification"in window&&Notification.permission==="granted"&&new Notification(`Alarm: ${e.label}`,{body:`Time: ${e.time}`,icon:"/assets/icon/favicon.png"}),alert(`\u{1F514} Alarm: ${e.label}
Time: ${e.time}`),e.repeatDays.length===0&&(e.isActive=!1,this.saveAlarms())}playAlarmSound(){try{this.audio=new Audio("/assets/sounds/alarm.mp3"),this.audio.loop=!0,this.audio.play(),setTimeout(()=>{this.audio&&(this.audio.pause(),this.audio=null)},3e4)}catch(e){console.error("Error playing alarm sound:",e)}}clearTimeout(e){let i=this.alarmTimeouts.get(e);i&&(clearTimeout(i),this.alarmTimeouts.delete(e))}clearAllTimeouts(){this.alarmTimeouts.forEach(e=>clearTimeout(e)),this.alarmTimeouts.clear()}saveAlarms(){localStorage.setItem("ordoo-alarms",JSON.stringify(this.alarms))}loadAlarms(){let e=localStorage.getItem("ordoo-alarms");e&&(this.alarms=JSON.parse(e),this.alarms.forEach(i=>{i.isActive&&this.scheduleAlarm(i)}))}resetNewAlarm(){this.newAlarm={id:"",time:"07:00",label:"Alarm",isActive:!0,repeatDays:[],sound:"default"},this.selectedHour="07",this.selectedMinute="00",this.selectedPeriod="AM"}requestNotificationPermission(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()}};s.\u0275fac=function(i){return new(i||s)(I(ae))},s.\u0275cmp=z({type:s,selectors:[["app-alarm"]],decls:50,vars:9,consts:[[1,"alarm-container"],[1,"main-layout"],[1,"form-section"],[1,"alarm-form"],[1,"form-row"],[1,"time-display"],[1,"time-picker-content"],[1,"time-wheels"],[1,"wheel"],[1,"wheel-label"],[1,"wheel-select",3,"ngModelChange","ngModel"],[3,"value"],["value","AM"],["value","PM"],["placeholder","Alarm name","fill","outline","label","Label",3,"ngModelChange","ngModel"],[1,"days-grid"],[1,"day-btn",3,"active"],["fill","outline","label","Sound",3,"ngModelChange","ngModel"],[1,"form-actions"],["fill","outline","color","medium"],["fill","solid","color","primary",3,"click"],[1,"alarms-section"],[1,"empty-state"],[1,"alarms-list"],[1,"day-btn",3,"click"],["fill","outline","color","medium",3,"click"],["name","alarm",1,"empty-icon"],[1,"alarm-item",3,"inactive"],[1,"alarm-item"],[1,"alarm-info"],[1,"time"],[1,"details"],[1,"label"],[1,"repeat"],[1,"alarm-controls"],[3,"ionChange","checked"],["fill","clear","size","small",3,"click"],["name","pencil"],["fill","clear","size","small","color","danger",3,"click"],["name","trash"]],template:function(i,t){i&1&&(n(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h2"),m(6),o(),n(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9),m(13,"Hour"),o(),n(14,"select",10),M("ngModelChange",function(l){return w(t.selectedHour,l)||(t.selectedHour=l),l}),u("ngModelChange",function(){return t.updateTime()}),v(15,de,2,2,"option",11,S),o()(),n(17,"div",8)(18,"div",9),m(19,"Minute"),o(),n(20,"select",10),M("ngModelChange",function(l){return w(t.selectedMinute,l)||(t.selectedMinute=l),l}),u("ngModelChange",function(){return t.updateTime()}),v(21,me,2,2,"option",11,S),o()(),n(23,"div",8)(24,"div",9),m(25,"Period"),o(),n(26,"select",10),M("ngModelChange",function(l){return w(t.selectedPeriod,l)||(t.selectedPeriod=l),l}),u("ngModelChange",function(){return t.updateTime()}),n(27,"option",12),m(28,"AM"),o(),n(29,"option",13),m(30,"PM"),o()()()()()()(),n(31,"div",4)(32,"ion-input",14),M("ngModelChange",function(l){return w(t.newAlarm.label,l)||(t.newAlarm.label=l),l}),o()(),n(33,"div",4)(34,"div",15),v(35,ge,2,3,"button",16,le),o()(),n(37,"div",4)(38,"ion-select",17),M("ngModelChange",function(l){return w(t.newAlarm.sound,l)||(t.newAlarm.sound=l),l}),v(39,ue,2,2,"ion-select-option",11,se),o()(),n(41,"div",18),k(42,pe,2,0,"ion-button",19),n(43,"ion-button",20),u("click",function(){return t.saveAlarm()}),m(44),o()()()(),n(45,"div",21)(46,"h2"),m(47,"Alarms"),o(),k(48,he,4,0,"div",22)(49,fe,3,0,"div",23),o()()()()),i&2&&(d(6),h(t.editingAlarm?"Edit Alarm":"Create Alarm"),d(8),y("ngModel",t.selectedHour),d(),b(t.hours),d(5),y("ngModel",t.selectedMinute),d(),b(t.minutes),d(5),y("ngModel",t.selectedPeriod),d(6),y("ngModel",t.newAlarm.label),d(3),b(t.weekDays),d(3),y("ngModel",t.newAlarm.sound),d(),b(t.sounds),d(3),O(t.editingAlarm?42:-1),d(2),E(" ",t.editingAlarm?"Update":"Save"," "),d(4),O(t.alarms.length===0?48:49))},dependencies:[H,B,$,F,V,N,W,j,L,U,G,q,J,R],styles:[`.alarm-container[_ngcontent-%COMP%]{height:100%;align-content:center;overflow:auto;padding:var(--spacing-md)}.main-layout[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-2xl);align-items:center;justify-content:center}.form-section[_ngcontent-%COMP%]{flex:1;width:100%}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--font-size-2xl);font-weight:var(--font-weight-bold);color:var(--ion-text-color);margin-bottom:var(--spacing-lg)}.alarms-section[_ngcontent-%COMP%]{background:var(--ion-card-background);border-radius:var(--border-radius-xl);padding:var(--spacing-md);box-shadow:0 2px 12px #00000014;border:1px solid var(--ion-color-light);height:530px;display:flex;flex-direction:column;flex:1}.alarms-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--font-size-2xl);font-weight:var(--font-weight-bold);color:var(--ion-text-color);margin-bottom:var(--spacing-lg);text-align:center;flex-shrink:0}.alarm-form[_ngcontent-%COMP%]{background:var(--ion-card-background);border-radius:var(--border-radius-xl);padding:var(--spacing-md);box-shadow:0 2px 12px #00000014;border:1px solid var(--ion-color-light);height:530px}.form-row[_ngcontent-%COMP%]{margin-bottom:var(--spacing-md);position:relative}.form-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.custom-time-picker[_ngcontent-%COMP%]{position:relative}.time-display[_ngcontent-%COMP%]{background:var(--ion-card-background);border:2px solid var(--ion-color-light);border-radius:var(--border-radius-lg);padding:var(--spacing-sm);text-align:center;font-size:var(--font-size-4xl);font-weight:var(--font-weight-bold);color:var(--ion-color-primary);cursor:pointer;transition:all .2s ease;position:relative}.time-display[_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary);background:#2567e80d}.time-picker-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.time-picker-modal[_ngcontent-%COMP%]{background:var(--ion-card-background);border-radius:var(--border-radius-xl);padding:var(--spacing-md);max-width:400px;width:90%;box-shadow:0 10px 30px #0000004d}.time-picker-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-lg)}.time-picker-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--ion-text-color);font-size:var(--font-size-xl);font-weight:var(--font-weight-semibold)}.time-picker-content[_ngcontent-%COMP%]{padding:var(--spacing-sm)}.time-wheels[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-sm);margin-bottom:var(--spacing-md)}.wheel[_ngcontent-%COMP%]{text-align:center;flex:1}.wheel[_ngcontent-%COMP%]   .wheel-label[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--ion-color-medium);margin-bottom:var(--spacing-xs);font-weight:var(--font-weight-medium)}.wheel[_ngcontent-%COMP%]   .wheel-select[_ngcontent-%COMP%]{width:100%;padding:var(--spacing-sm);border:2px solid var(--ion-color-light);border-radius:var(--border-radius-md);background:var(--ion-background-color);color:var(--ion-text-color);font-size:var(--font-size-base);font-weight:var(--font-weight-semibold);text-align:center;appearance:none;background-image:url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23666" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');background-repeat:no-repeat;background-position:right 8px center;background-size:12px}.wheel[_ngcontent-%COMP%]   .wheel-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--ion-color-primary)}.days-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--spacing-sm)}.days-grid[_ngcontent-%COMP%]   .day-btn[_ngcontent-%COMP%]{background:var(--ion-background-color);border:2px solid var(--ion-color-light);border-radius:var(--border-radius-md);padding:var(--spacing-sm);font-size:var(--font-size-sm);font-weight:var(--font-weight-semibold);color:var(--ion-text-color);cursor:pointer;transition:all .2s ease;flex:1}.days-grid[_ngcontent-%COMP%]   .day-btn[_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary)}.days-grid[_ngcontent-%COMP%]   .day-btn.active[_ngcontent-%COMP%]{background:var(--ion-color-primary);border-color:var(--ion-color-primary);color:#fff}.form-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-md);margin-top:var(--spacing-md)}.form-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;--border-radius: var(--border-radius-lg);height:48px;font-weight:var(--font-weight-semibold)}.empty-state[_ngcontent-%COMP%]{text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:3rem;color:var(--ion-color-medium);margin-bottom:var(--spacing-md)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:var(--font-size-base)}.alarms-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-sm);overflow-y:auto;flex:1;padding-right:var(--spacing-xs)}.alarms-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.alarms-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--ion-color-light);border-radius:3px}.alarms-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--ion-color-primary);border-radius:3px}.alarms-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--ion-color-primary-shade)}.alarm-item[_ngcontent-%COMP%]{background:var(--ion-background-color);border-radius:var(--border-radius-lg);padding:var(--spacing-md);border:1px solid var(--ion-color-light);display:flex;justify-content:space-between;align-items:center;transition:all .2s ease}.alarm-item[_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary)}.alarm-item.inactive[_ngcontent-%COMP%]{opacity:.6}.alarm-item.inactive[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.alarm-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md)}.alarm-info[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:var(--font-size-2xl);font-weight:var(--font-weight-bold);color:var(--ion-color-primary);font-family:Inter,monospace;min-width:70px}.alarm-info[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:var(--font-size-base);font-weight:var(--font-weight-semibold);color:var(--ion-text-color);margin-bottom:var(--spacing-xs)}.alarm-info[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .repeat[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--ion-color-medium);font-weight:var(--font-weight-medium)}.alarm-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm)}.alarm-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px}.alarm-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:var(--font-size-xl)}@media (max-width: 992px){.main-layout[_ngcontent-%COMP%]{flex-direction:column;gap:var(--spacing-md)}.alarms-section[_ngcontent-%COMP%]{width:100%}.alarm-container[_ngcontent-%COMP%]{padding:var(--spacing-md)}}`]});let a=s;return a})();export{Ae as AlarmPage};
