import{a as ae}from"./chunk-OKNZTMHN.js";import"./chunk-G254VQN3.js";import{b as X}from"./chunk-4HVVZ7VC.js";import{b as re}from"./chunk-YBODFWNC.js";import{B as d,C as s,Kb as L,Lb as q,M as O,N as g,Na as z,Pb as R,Q as v,S as M,Sb as G,Xb as Y,Z as P,_ as x,_b as Q,ca as b,da as t,db as m,ea as o,eb as V,fa as p,fb as D,gc as H,gd as oe,hb as E,hc as J,ib as T,ja as y,jb as N,jc as K,ka as f,kc as W,mc as Z,pa as S,pb as B,qa as k,qb as j,ra as I,sb as U,tb as A,ua as F,uc as ee,vc as te,wa as a,wc as ne,zc as ie}from"./chunk-TS35J3DX.js";import"./chunk-LVT7LAFM.js";import"./chunk-QUJFQN2Y.js";import"./chunk-OSWHOA5B.js";import"./chunk-NMFGAPTO.js";import"./chunk-D7K6MB32.js";import"./chunk-TL5KAYV2.js";import"./chunk-AGPRGGHL.js";import"./chunk-7CKTJNM7.js";import"./chunk-KNGCU3N4.js";import"./chunk-3COQWRSL.js";import"./chunk-FJEPPHGG.js";import"./chunk-JLVFVAKY.js";import"./chunk-6OS5WUMZ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-XKPZ2LXV.js";import"./chunk-CKP3SGE2.js";import"./chunk-M6BWGQD5.js";import"./chunk-XTA6VOZK.js";import"./chunk-ALL2FOAL.js";import"./chunk-7HDUECN2.js";import"./chunk-I3XFR2VW.js";import"./chunk-J7JKH43X.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as C,b as w,i as h}from"./chunk-VBFW7A5V.js";var le=["dateOfBirthInput"];function ce(u,l){u&1&&(t(0,"span"),a(1,"Complete Setup"),o())}function de(u,l){u&1&&(t(0,"span"),a(1,"Setting up..."),o())}var xe=(()=>{let l=class l{constructor(i,n,e,r,c){this.formBuilder=i,this.navCtrl=n,this.cloudinaryService=e,this.loader=r,this.authService=c,this.selectedImageUrl="",this.selectedFile=null,this.dob=null,this.isDateFocused=!1,this.isSubmitting=!1,Z({personOutline:oe,callOutline:te,cameraOutline:ne,calendarOutline:ee,checkmarkCircle:ie}),this.profileForm=this.formBuilder.group({full_name:["",[m.required,m.minLength(2)]],phone_number:["",[m.required]],gender:["",[m.required]],dob:["",[m.required]],bio:["",[m.required,m.maxLength(500)]]})}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.initializeDatepicker()},100)}ngOnDestroy(){this.destroyDatepicker()}initializeDatepicker(){$(this.dateOfBirthInput.nativeElement).datepicker({format:"mm/dd/yyyy",autoclose:!0,todayHighlight:!0,minViewMode:0,maxViewMode:2,container:"body",orientation:"auto"}).on("changeDate",i=>{this.dob=i.date,this.profileForm.patchValue({dob:i.date}),this.profileForm.get("dob")?.markAsTouched()})}destroyDatepicker(){$(this.dateOfBirthInput.nativeElement).datepicker("destroy")}onImageSelect(i){let n=i.target.files[0];if(n){this.selectedFile=n;let e=new FileReader;e.onload=r=>{this.selectedImageUrl=r.target.result},e.readAsDataURL(n)}}triggerImageUpload(){document.getElementById("imageUpload")?.click()}onSubmit(){return h(this,null,function*(){this.isSubmitting||(this.profileForm.markAllAsTouched(),this.profileForm.valid&&(this.isSubmitting=!0,yield this.loader.show("Setting up profile..."),this.selectedFile?this.cloudinaryService.uploadLargeFile(this.selectedFile).subscribe({next:i=>{i.type===4&&i.body&&this.updateProfile(i.body.public_id)},error:i=>h(this,null,function*(){this.isSubmitting=!1,yield this.loader.hide(),console.error("Upload failed:",i)})}):this.updateProfile("")))})}updateProfile(i){return h(this,null,function*(){let n=w(C({},this.profileForm.value),{avatar_url:i});this.cloudinaryService.updateProfile(n).subscribe({next:e=>h(this,null,function*(){console.log("Profile updated:",e),e.profile&&(yield this.authService.updateProfile(e.profile)),this.isSubmitting=!1,yield this.loader.hide(),this.navCtrl.navigateRoot("/workspace")}),error:e=>h(this,null,function*(){this.isSubmitting=!1,yield this.loader.hide(),console.error("Profile update failed:",e)})})})}onPhoneInput(i){let n=i.target.value.replace(/[^0-9]/g,""),e=this.formatIndianPhoneNumber(n);this.profileForm.patchValue({phone_number:e})}formatIndianPhoneNumber(i){if(!i)return"";let n=i.replace(/[^\d]/g,""),e=n.length;return e<6?n:e<11?`${n.slice(0,5)} ${n.slice(5)}`:`${n.slice(0,5)} ${n.slice(5,10)}`}skipSetup(){this.navCtrl.navigateRoot("/workspace")}onDateBlur(){this.isDateFocused=!1,this.profileForm.get("dob")?.markAsTouched()}get isDateTouched(){return this.profileForm.get("dob")?.touched||!1}get isDateInvalid(){return this.profileForm.get("dob")?.invalid||!1}get isDateValid(){return this.profileForm.get("dob")?.valid||!1}};l.\u0275fac=function(n){return new(n||l)(v(j),v(A),v(ae),v(re),v(X))},l.\u0275cmp=M({type:l,selectors:[["app-profile-setup"]],viewQuery:function(n,e){if(n&1&&S(le,5),n&2){let r;k(r=I())&&(e.dateOfBirthInput=r.first)}},decls:56,vars:16,consts:[["dateOfBirthInput",""],[1,"profile-setup-content",3,"scrollY"],[1,"setup-wrapper"],[1,"left-section"],[1,"brand-container"],["src","assets/icon/ordoo-logo.svg","alt","Ordoo Logo",1,"brand-logo"],[1,"brand-title"],[1,"brand-text"],[1,"right-section"],[1,"scrollable-content"],[1,"form-container"],[1,"form-title"],[1,"form-subtitle"],["autocomplete","off",1,"profile-form",3,"ngSubmit","formGroup"],[1,"image-upload-section"],[1,"avatar-container",3,"click"],[1,"profile-avatar"],["alt","Profile",3,"src"],[1,"camera-overlay"],["name","camera-outline"],["type","file","id","imageUpload","accept","image/*",2,"display","none",3,"change"],["name","person-outline",1,"profile-floating-icons-left"],["formControlName","full_name","labelPlacement","floating","type","text","label","Full Name","fill","outline","placeholder","Enter your full name","mode","md","autocomplete","name",1,"common-input","common-input-design-with-icon-left"],["name","call-outline",1,"profile-floating-icons-left"],["formControlName","phone","labelPlacement","floating","type","tel","label","Phone Number","fill","outline","placeholder","98765 43210","mode","md","autocomplete","tel",1,"common-input","common-input-design-with-icon-left",3,"ionInput"],["formControlName","gender","labelPlacement","floating","label","Gender","fill","outline","mode","md",1,"common-input"],["value","male"],["value","female"],["value","other"],["value","prefer-not-to-say"],["name","calendar-outline",1,"profile-floating-icons-left"],[1,"date-input-wrapper"],[1,"floating-label"],["type","text","placeholder","Select date of birth","readonly","",3,"focus","blur"],["formControlName","bio","labelPlacement","floating","label","Bio","fill","outline","placeholder","Tell us about yourself...","mode","md","rows","5","maxlength","500","counter","true",1,"common-input"],["mode","md","expand","block","type","submit",1,"btn-primary",3,"disabled"],[1,"skip-section"],[1,"skip-text"],[1,"skip-link",3,"click"]],template:function(n,e){if(n&1){let r=y();t(0,"ion-content",1)(1,"div",2)(2,"div",3)(3,"div",4),p(4,"img",5),t(5,"h2",6),a(6,"Complete Your Profile"),o(),t(7,"p",7),a(8,"Add your details to personalize your Ordoo experience"),o()()(),t(9,"div",8)(10,"div",9)(11,"div",10)(12,"h2",11),a(13,"Profile"),o(),t(14,"p",12),a(15,"Tell us about yourself"),o(),t(16,"form",13),f("ngSubmit",function(){return d(r),s(e.onSubmit())}),t(17,"div",14)(18,"div",15),f("click",function(){return d(r),s(e.triggerImageUpload())}),t(19,"ion-avatar",16),p(20,"img",17),t(21,"div",18),p(22,"ion-icon",19),o()()(),t(23,"input",20),f("change",function(_){return d(r),s(e.onImageSelect(_))}),o()(),t(24,"ion-item"),p(25,"ion-icon",21)(26,"ion-input",22),o(),t(27,"ion-item"),p(28,"ion-icon",23),t(29,"ion-input",24),f("ionInput",function(_){return d(r),s(e.onPhoneInput(_))}),o()(),t(30,"ion-item")(31,"ion-select",25)(32,"ion-select-option",26),a(33,"Male"),o(),t(34,"ion-select-option",27),a(35,"Female"),o(),t(36,"ion-select-option",28),a(37,"Other"),o(),t(38,"ion-select-option",29),a(39,"Prefer not to say"),o()()(),t(40,"ion-item"),p(41,"ion-icon",30),t(42,"div",31)(43,"label",32),a(44,"Date of Birth"),o(),t(45,"input",33,0),f("focus",function(){return d(r),s(e.isDateFocused=!0)})("blur",function(){return d(r),s(e.onDateBlur())}),o()()(),t(47,"ion-item"),p(48,"ion-textarea",34),o(),t(49,"ion-button",35),P(50,ce,2,0,"span"),P(51,de,2,0,"span"),o()(),t(52,"div",36)(53,"p",37)(54,"ion-text",38),f("click",function(){return d(r),s(e.skipSetup())}),a(55," Skip for now "),o()()()()()()()()}n&2&&(b("scrollY",!1),g(16),b("formGroup",e.profileForm),g(4),b("src",e.selectedImageUrl||"assets/icon/default-avatar.svg",O),g(22),F("has-focus",e.isDateFocused)("has-value",e.dob)("ion-touched",e.isDateTouched)("ion-invalid",e.isDateInvalid)("ion-valid",e.isDateValid),g(7),b("disabled",!e.profileForm.valid||e.isSubmitting),g(),x(e.isSubmitting?-1:50),g(),x(e.isSubmitting?51:-1))},dependencies:[R,q,J,G,H,Q,L,K,Y,W,z,U,E,V,D,B,T,N],styles:[".setup-wrapper[_ngcontent-%COMP%]{display:flex;min-height:100vh}.left-section[_ngcontent-%COMP%]{flex:1;background:var(--ion-color-primary);display:flex;align-items:center;justify-content:center;padding:var(--spacing-2xl);min-height:100vh}@media (max-width: 1024px){.left-section[_ngcontent-%COMP%]{display:none}}.brand-container[_ngcontent-%COMP%]{text-align:center;max-width:400px}.brand-logo[_ngcontent-%COMP%]{width:120px;height:120px;margin-bottom:var(--spacing-xl);background:var(--ion-white-color-background);border-radius:var(--border-radius-xl);padding:var(--spacing-md);box-shadow:0 8px 32px #0000001a}.brand-title[_ngcontent-%COMP%]{font-size:var(--font-size-11xl);font-weight:var(--font-weight-bold);color:var(--ion-white-color-text);margin:0 0 var(--spacing-md)}.brand-text[_ngcontent-%COMP%]{font-size:var(--font-size-xl);color:var(--ion-white-color-text);margin:0}.right-section[_ngcontent-%COMP%]{flex:1;display:flex;height:100vh;overflow:hidden}.scrollable-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:var(--spacing-md);min-height:0}.form-container[_ngcontent-%COMP%]{max-width:400px;width:100%;margin:0 auto;min-height:calc(100vh - 2 * var(--spacing-lg));display:flex;flex-direction:column;justify-content:center}.logo-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-md);display:block}@media (min-width: 1024px){.logo-section[_ngcontent-%COMP%]{display:none}}.logo-circle[_ngcontent-%COMP%]{width:60px;height:60px;background:var(--ion-white-color-background);border-radius:var(--border-radius-lg);display:flex;align-items:center;justify-content:center;margin:0 auto var(--spacing-md);box-shadow:0 4px 16px #0000001a}.logo-icon[_ngcontent-%COMP%]{width:40px;height:40px}.app-title[_ngcontent-%COMP%]{font-size:var(--font-size-5xl);font-weight:var(--font-weight-bold);margin:0}.form-title[_ngcontent-%COMP%]{font-size:var(--font-size-5xl);font-weight:var(--font-weight-bold);margin:0 0 var(--spacing-xs);text-align:center}.form-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0 0 var(--spacing-xl);font-size:var(--font-size-base);text-align:center}.profile-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-md)}.image-upload-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-lg)}.avatar-container[_ngcontent-%COMP%]{display:inline-block;position:relative;cursor:pointer}.profile-avatar[_ngcontent-%COMP%]{width:80px;height:80px;border:2px solid var(--ion-color-primary)}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.camera-overlay[_ngcontent-%COMP%]{position:absolute;bottom:-2px;inset-inline-end:-2px;width:24px;height:24px;background:var(--ion-color-primary);border-radius:50%;display:flex;align-items:center;justify-content:center;border:2px solid var(--ion-background-color)}.camera-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-white-color-text);font-size:var(--font-size-sm)}.profile-floating-icons-left[_ngcontent-%COMP%]{position:absolute;top:18px;inset-inline-start:12px;z-index:999;color:var(--ion-text-color)}.date-input-wrapper[_ngcontent-%COMP%]{width:100%;position:relative}.date-input-wrapper[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{position:absolute;top:50%;inset-inline-start:46px;transform:translateY(-50%);font-size:var(--font-size-base);color:var(--ion-text-color);background:transparent;padding:0;transition:all .2s ease;pointer-events:none;z-index:1}.date-input-wrapper.has-focus[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.has-value[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{top:-8px;inset-inline-start:16px;transform:translateY(0);font-size:var(--font-size-sm);color:var(--ion-text-color);background:var(--ion-background-color);padding:0 4px;font-weight:var(--font-weight-medium)}.date-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:16px;padding-inline-start:46px!important;border:1.5px solid var(--ion-text-color);border-radius:8px;background:var(--ion-background-color);color:var(--ion-text-color);font-size:var(--font-size-base);cursor:pointer;box-sizing:border-box;transition:all .2s ease}.date-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.date-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:transparent}.date-input-wrapper.has-focus[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder, .date-input-wrapper.has-value[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--ion-color-medium)}.date-input-wrapper.ion-touched.ion-invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:var(--ion-color-danger)!important}.date-input-wrapper.ion-touched.ion-invalid.has-focus[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-invalid.has-value[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-invalid[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{color:var(--ion-color-danger)!important}.date-input-wrapper.ion-touched.ion-valid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:var(--ion-text-color)!important}.date-input-wrapper.ion-touched.ion-valid.has-focus[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-valid.has-value[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-valid[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{color:var(--ion-text-color)!important}.skip-section[_ngcontent-%COMP%]{text-align:center;margin-top:var(--spacing-md)}.skip-text[_ngcontent-%COMP%]{font-size:var(--font-size-md);margin:0}.skip-link[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:var(--font-weight-semibold);cursor:pointer;text-decoration:none}.skip-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.date-modal[_ngcontent-%COMP%]{padding:var(--spacing-lg)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-lg)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:var(--font-size-xl);font-weight:var(--font-weight-semibold);margin:0}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-width: 0;--inner-border-width: 0;--padding-start: 0;--padding-end: 0;--inner-padding-start: 0;--inner-padding-end: 0;overflow:visible!important;--background: none}form[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--border-color: var( --ion-text-color) !important;--border-width: 1.5px !important;--border-radius: 8px !important}form[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--border-color: var( --ion-text-color) !important;--border-width: 1.5px !important;--border-radius: 8px !important}ion-modal[_ngcontent-%COMP%]{--width: inherit;--min-width: inherit;--max-width: inherit;--height: inherit;--min-height: auto;--max-height: inherit}"]});let u=l;return u})();export{xe as ProfileSetupPage};
