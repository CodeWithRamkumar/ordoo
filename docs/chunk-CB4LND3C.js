import{b as N}from"./chunk-B7XTWBX7.js";import{a as j}from"./chunk-YZ7OZVHI.js";import{a as D}from"./chunk-DRB3S4YK.js";import{$ as o,$a as w,Bb as F,Ha as C,J as p,K as O,La as x,Lc as A,M as c,O as b,U as u,V as f,Xa as _,Xb as L,Ya as y,Z as h,Za as E,Zb as z,_ as e,aa as v,ab as S,ac as R,bb as I,fa as d,fb as M,hb as T,ib as k,lc as W,ra as a,ta as P}from"./chunk-DINEKAUJ.js";import{i as l}from"./chunk-VBFW7A5V.js";function G(s,r){s&1&&(e(0,"div",11),a(1," Invalid or expired OTP. Please try again. "),o())}function V(s,r){s&1&&(e(0,"div",11),a(1," Please enter complete 6-digit OTP "),o())}var at=(()=>{let r=class r{constructor(i,m,t,n,g,B){this.fb=i,this.navCtrl=m,this.http=t,this.config=n,this.loader=g,this.authService=B,this.close=new O,this.email="",this.otpError=!1,this.otpLength=0,R({close:W,shieldCheckmarkOutline:A}),this.otpForm=this.fb.group({otp:["",[_.required,_.minLength(6)]]})}ngOnInit(){}verifyOTP(){return l(this,null,function*(){this.otpError=!1,this.otpForm.valid&&(yield this.loader.show("Verifying OTP..."),this.http.post(`${this.config.API_BASE_URL}/auth/verify-otp`,{email:this.email,otp:this.otpForm.value.otp}).subscribe({next:i=>l(this,null,function*(){yield this.authService.saveUserData(i),yield this.loader.hide(),this.close.emit(),this.navCtrl.navigateRoot("/workspace")}),error:i=>l(this,null,function*(){yield this.loader.hide(),this.otpError=!0})}))})}clearOtpError(){this.otpError&&(this.otpError=!1,this.otpForm.get("otp")?.setErrors(null))}onOtpChange(i){this.clearOtpError(),this.otpLength=i.detail.value?.length||0}resendOTP(){return l(this,null,function*(){yield this.loader.show("Resending OTP..."),this.http.post(`${this.config.API_BASE_URL}/auth/send-otp`,{email:this.email}).subscribe({next:i=>l(this,null,function*(){yield this.loader.hide(),this.otpForm.reset(),this.otpError=!1}),error:i=>l(this,null,function*(){yield this.loader.hide(),console.error("Resend OTP error:",i)})})})}};r.\u0275fac=function(m){return new(m||r)(c(M),c(k),c(x),c(j),c(D),c(N))},r.\u0275cmp=b({type:r,selectors:[["app-login-with-otp"]],inputs:{email:"email"},outputs:{close:"close"},decls:22,vars:6,consts:[[1,"otp-modal-wrapper"],["fill","clear",1,"close-button",3,"click"],["name","close"],[1,"form-container"],[1,"illustration"],[1,"otp-icon"],["name","shield-checkmark-outline"],[1,"form-title"],[1,"form-subtitle"],[1,"otp-form",3,"ngSubmit","formGroup"],["formControlName","otp",1,"common-input",3,"ionInput","length"],[1,"error-text"],["mode","md","expand","block","type","submit",1,"btn-primary",3,"disabled"],[1,"resend-section"],[1,"resend-text"],["fill","clear",1,"resend-button",3,"click"]],template:function(m,t){if(m&1&&(e(0,"div",0)(1,"ion-button",1),d("click",function(){return t.close.emit()}),v(2,"ion-icon",2),o(),e(3,"div",3)(4,"div",4)(5,"div",5),v(6,"ion-icon",6),o()(),e(7,"h2",7),a(8,"Enter OTP"),o(),e(9,"p",8),a(10),o(),e(11,"form",9),d("ngSubmit",function(){return t.verifyOTP()}),e(12,"ion-input-otp",10),d("ionInput",function(g){return t.onOtpChange(g)}),o(),u(13,G,2,0,"div",11),u(14,V,2,0,"div",11),e(15,"ion-button",12),a(16," Verify OTP "),o()(),e(17,"div",13)(18,"p",14),a(19,"Didn't receive the code?"),o(),e(20,"ion-button",15),d("click",function(){return t.resendOTP()}),a(21," Resend Code "),o()()()()),m&2){let n;p(10),P("We've sent a 6-digit verification code to ",t.email),p(),h("formGroup",t.otpForm),p(),h("length",6),p(),f(t.otpError?13:-1),p(),f(!t.otpError&&((n=t.otpForm.get("otp"))!=null&&n.invalid)&&((n=t.otpForm.get("otp"))!=null&&n.touched)?14:-1),p(),h("disabled",t.otpLength<6)}},dependencies:[F,z,L,C,T,w,y,E,S,I],styles:["[_nghost-%COMP%]{display:block}.otp-modal-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.close-button[_ngcontent-%COMP%]{position:absolute;top:var(--spacing-sm);inset-inline-end:var(--spacing-sm);z-index:1000;--color: var( --ion-text-color)}.form-container[_ngcontent-%COMP%]{width:100%;padding:var(--spacing-xl);border-radius:var(--border-radius-xl);box-shadow:0 20px 40px #0000001a;text-align:center;position:relative}.illustration[_ngcontent-%COMP%]{margin-bottom:var(--spacing-md)}.otp-icon[_ngcontent-%COMP%]{width:60px;height:60px;background:var(--ion-color-primary);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto}.otp-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:30px;height:30px;color:var(--ion-white-color-text)}.form-title[_ngcontent-%COMP%]{font-size:var(--font-size-3xl);font-weight:var(--font-weight-bold);margin:0 0 var(--spacing-sm)}.form-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0;font-size:var(--font-size-sm)}.resend-section[_ngcontent-%COMP%]{margin-top:var(--spacing-md);padding-top:var(--spacing-md);border-top:1px solid var(--ion-text-color)}.resend-text[_ngcontent-%COMP%]{font-size:var(--font-size-sm);margin:0 0 var(--spacing-xs)}.resend-button[_ngcontent-%COMP%]{--color: var(--ion-color-primary);font-weight:var(--font-weight-medium);font-size:var(--font-size-sm)}.error-text[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:var(--font-size-sm);margin-top:var(--spacing-sm)}"]});let s=r;return s})();export{at as a};
