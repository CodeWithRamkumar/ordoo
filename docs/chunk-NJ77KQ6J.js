import{a as de}from"./chunk-DRB3S4YK.js";import{$ as r,$a as A,$b as oe,A as p,Ab as J,Bb as K,Fb as W,Ha as T,Hc as pe,I as F,Ib as X,J as b,Ka as C,La as U,M as P,Nb as Z,O as z,Qb as ee,Xa as m,Xb as te,Ya as j,Yb as ne,Z as x,Za as L,_ as i,_b as ie,a as k,aa as d,ab as R,ac as re,bb as q,ea as D,eb as G,fa as g,fb as Y,gc as ae,hb as Q,hc as le,ib as H,ic as ce,ka as V,kc as se,la as B,ma as E,pa as N,q as S,ra as l,t as I,z as s}from"./chunk-DINEKAUJ.js";import"./chunk-GAQMLLH7.js";import"./chunk-QUJFQN2Y.js";import"./chunk-GV7ROTFX.js";import"./chunk-WP3PW2FM.js";import"./chunk-RAIJBZAF.js";import"./chunk-TL5KAYV2.js";import"./chunk-5DK6WUVE.js";import"./chunk-N6MIILRQ.js";import"./chunk-VHD5V3JE.js";import"./chunk-3COQWRSL.js";import"./chunk-HGIQAHIR.js";import"./chunk-EPAF7B2K.js";import"./chunk-CU2LIOPH.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-EQDF3Z2M.js";import"./chunk-CKP3SGE2.js";import"./chunk-SUU46OAF.js";import"./chunk-XTA6VOZK.js";import"./chunk-ALL2FOAL.js";import"./chunk-7HDUECN2.js";import"./chunk-I3XFR2VW.js";import"./chunk-J7JKH43X.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as M,b as y,i as v}from"./chunk-VBFW7A5V.js";var me=(()=>{let a=class a{constructor(e){this.http=e,this.apiUrl="http://localhost:3001/api",this.chunkSize=5*1024*1024}uploadLargeFile(e){return e.size<=this.chunkSize?this.uploadSingleFile(e):this.uploadChunkedFile(e)}updateProfile(e){return this.http.put(`${this.apiUrl}/user/profile/setup`,e)}uploadSingleFile(e){let t=new FormData;return t.append("file",e),this.http.post(`${this.apiUrl}/upload`,t,{reportProgress:!0,observe:"events"})}uploadChunkedFile(e){return new k(t=>{let n=Math.ceil(e.size/this.chunkSize),o=0,c=Date.now().toString(),f=_=>{let O=_*this.chunkSize,ue=Math.min(O+this.chunkSize,e.size),ge=e.slice(O,ue),h=new FormData;h.append("chunk",ge),h.append("chunkIndex",_.toString()),h.append("totalChunks",n.toString()),h.append("uploadId",c),h.append("fileName",e.name),this.http.post(`${this.apiUrl}/upload-chunk`,h).subscribe({next:w=>{o++;let fe=o/n*100;o===n?(t.next({type:C.Response,body:w}),t.complete()):(t.next({type:C.UploadProgress,loaded:fe,total:100}),f(_+1))},error:w=>t.error(w)})};f(0)})}};a.\u0275fac=function(t){return new(t||a)(I(U))},a.\u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"});let u=a;return u})();var be=["dateOfBirthInput"],Fe=(()=>{let a=class a{constructor(e,t,n,o){this.formBuilder=e,this.navCtrl=t,this.cloudinaryService=n,this.loader=o,this.selectedImageUrl="",this.selectedFile=null,this.dateOfBirth=null,this.isDateFocused=!1,re({personOutline:pe,callOutline:le,cameraOutline:ce,calendarOutline:ae,checkmarkCircle:se}),this.profileForm=this.formBuilder.group({fullName:["",[m.required,m.minLength(2)]],phone:["",[m.required]],gender:["",[m.required]],dateOfBirth:["",[m.required]],bio:["",[m.required,m.maxLength(500)]]})}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.initializeDatepicker()},100)}ngOnDestroy(){this.destroyDatepicker()}initializeDatepicker(){$(this.dateOfBirthInput.nativeElement).datepicker({format:"mm/dd/yyyy",autoclose:!0,todayHighlight:!0,minViewMode:0,maxViewMode:2,container:"body",orientation:"auto"}).on("changeDate",e=>{this.dateOfBirth=e.date,this.profileForm.patchValue({dateOfBirth:e.date}),this.profileForm.get("dateOfBirth")?.markAsTouched()})}destroyDatepicker(){$(this.dateOfBirthInput.nativeElement).datepicker("destroy")}onImageSelect(e){let t=e.target.files[0];if(t){this.selectedFile=t;let n=new FileReader;n.onload=o=>{this.selectedImageUrl=o.target.result},n.readAsDataURL(t)}}triggerImageUpload(){document.getElementById("imageUpload")?.click()}onSubmit(){return v(this,null,function*(){this.profileForm.markAllAsTouched(),this.profileForm.valid&&(yield this.loader.show("Setting up profile..."),this.selectedFile?this.cloudinaryService.uploadLargeFile(this.selectedFile).subscribe({next:e=>{e.type===4&&e.body&&this.updateProfile(e.body.public_id)},error:e=>v(this,null,function*(){yield this.loader.hide(),console.error("Upload failed:",e)})}):this.updateProfile(""))})}updateProfile(e){return v(this,null,function*(){let t=y(M({},this.profileForm.value),{profileImage:e});this.cloudinaryService.updateProfile(t).subscribe({next:n=>v(this,null,function*(){console.log("Profile updated:",n),yield this.loader.hide(),this.navCtrl.navigateRoot("/workspace")}),error:n=>v(this,null,function*(){yield this.loader.hide(),console.error("Profile update failed:",n)})})})}onPhoneInput(e){let t=e.target.value.replace(/[^0-9]/g,""),n=this.formatPhoneNumber(t);this.profileForm.patchValue({phone:n})}formatPhoneNumber(e){if(!e)return"";let t=e.replace(/[^\d]/g,""),n=t.length;return n<4?t:n<7?`(${t.slice(0,3)}) ${t.slice(3)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`}skipSetup(){this.navCtrl.navigateRoot("/workspace")}onDateBlur(){this.isDateFocused=!1,this.profileForm.get("dateOfBirth")?.markAsTouched()}get isDateTouched(){return this.profileForm.get("dateOfBirth")?.touched||!1}get isDateInvalid(){return this.profileForm.get("dateOfBirth")?.invalid||!1}get isDateValid(){return this.profileForm.get("dateOfBirth")?.valid||!1}};a.\u0275fac=function(t){return new(t||a)(P(Y),P(H),P(me),P(de))},a.\u0275cmp=z({type:a,selectors:[["app-profile-setup"]],viewQuery:function(t,n){if(t&1&&V(be,5),t&2){let o;B(o=E())&&(n.dateOfBirthInput=o.first)}},decls:55,vars:14,consts:[["dateOfBirthInput",""],[1,"profile-setup-content",3,"scrollY"],[1,"setup-wrapper"],[1,"left-section"],[1,"brand-container"],["src","assets/icon/ordoo-logo.svg","alt","Ordoo Logo",1,"brand-logo"],[1,"brand-title"],[1,"brand-text"],[1,"right-section"],[1,"scrollable-content"],[1,"form-container"],[1,"form-title"],[1,"form-subtitle"],[1,"profile-form",3,"ngSubmit","formGroup"],[1,"image-upload-section"],[1,"avatar-container",3,"click"],[1,"profile-avatar"],["alt","Profile",3,"src"],[1,"camera-overlay"],["name","camera-outline"],["type","file","id","imageUpload","accept","image/*",2,"display","none",3,"change"],["name","person-outline",1,"profile-floating-icons-left"],["formControlName","fullName","labelPlacement","floating","type","text","label","Full Name","fill","outline","placeholder","Enter your full name","mode","md",1,"common-input","common-input-design-with-icon-left"],["name","call-outline",1,"profile-floating-icons-left"],["formControlName","phone","labelPlacement","floating","type","tel","label","Phone Number","fill","outline","placeholder","(123) 456-7890","mode","md",1,"common-input","common-input-design-with-icon-left",3,"ionInput"],["formControlName","gender","labelPlacement","floating","label","Gender","fill","outline","mode","md",1,"common-input"],["value","male"],["value","female"],["value","other"],["value","prefer-not-to-say"],["name","calendar-outline",1,"profile-floating-icons-left"],[1,"date-input-wrapper"],[1,"floating-label"],["type","text","placeholder","Select date of birth","readonly","",3,"focus","blur"],["formControlName","bio","labelPlacement","floating","label","Bio","fill","outline","placeholder","Tell us about yourself...","mode","md","rows","5","maxlength","500","counter","true",1,"common-input"],["mode","md","expand","block","type","submit",1,"btn-primary",3,"disabled"],[1,"skip-section"],[1,"skip-text"],[1,"skip-link",3,"click"]],template:function(t,n){if(t&1){let o=D();i(0,"ion-content",1)(1,"div",2)(2,"div",3)(3,"div",4),d(4,"img",5),i(5,"h2",6),l(6,"Complete Your Profile"),r(),i(7,"p",7),l(8,"Add your details to personalize your Ordoo experience"),r()()(),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"h2",11),l(13,"Profile"),r(),i(14,"p",12),l(15,"Tell us about yourself"),r(),i(16,"form",13),g("ngSubmit",function(){return s(o),p(n.onSubmit())}),i(17,"div",14)(18,"div",15),g("click",function(){return s(o),p(n.triggerImageUpload())}),i(19,"ion-avatar",16),d(20,"img",17),i(21,"div",18),d(22,"ion-icon",19),r()()(),i(23,"input",20),g("change",function(f){return s(o),p(n.onImageSelect(f))}),r()(),i(24,"ion-item"),d(25,"ion-icon",21)(26,"ion-input",22),r(),i(27,"ion-item"),d(28,"ion-icon",23),i(29,"ion-input",24),g("ionInput",function(f){return s(o),p(n.onPhoneInput(f))}),r()(),i(30,"ion-item")(31,"ion-select",25)(32,"ion-select-option",26),l(33,"Male"),r(),i(34,"ion-select-option",27),l(35,"Female"),r(),i(36,"ion-select-option",28),l(37,"Other"),r(),i(38,"ion-select-option",29),l(39,"Prefer not to say"),r()()(),i(40,"ion-item"),d(41,"ion-icon",30),i(42,"div",31)(43,"label",32),l(44,"Date of Birth"),r(),i(45,"input",33,0),g("focus",function(){return s(o),p(n.isDateFocused=!0)})("blur",function(){return s(o),p(n.onDateBlur())}),r()()(),i(47,"ion-item"),d(48,"ion-textarea",34),r(),i(49,"ion-button",35),l(50," Complete Setup "),r()(),i(51,"div",36)(52,"p",37)(53,"ion-text",38),g("click",function(){return s(o),p(n.skipSetup())}),l(54," Skip for now "),r()()()()()()()()}t&2&&(x("scrollY",!1),b(16),x("formGroup",n.profileForm),b(4),x("src",n.selectedImageUrl||"assets/icon/default-avatar.svg",F),b(22),N("has-focus",n.isDateFocused)("has-value",n.dateOfBirth)("ion-touched",n.isDateTouched)("ion-invalid",n.isDateInvalid)("ion-valid",n.isDateValid),b(7),x("disabled",!n.profileForm.valid))},dependencies:[W,K,ne,X,te,ee,J,ie,Z,oe,T,Q,A,j,L,G,R,q],styles:[".setup-wrapper[_ngcontent-%COMP%]{display:flex;min-height:100vh}.left-section[_ngcontent-%COMP%]{flex:1;background:var(--ion-color-primary);display:flex;align-items:center;justify-content:center;padding:var(--spacing-2xl);min-height:100vh}@media (max-width: 1024px){.left-section[_ngcontent-%COMP%]{display:none}}.brand-container[_ngcontent-%COMP%]{text-align:center;max-width:400px}.brand-logo[_ngcontent-%COMP%]{width:120px;height:120px;margin-bottom:var(--spacing-xl);background:var(--ion-white-color-background);border-radius:var(--border-radius-xl);padding:var(--spacing-md);box-shadow:0 8px 32px #0000001a}.brand-title[_ngcontent-%COMP%]{font-size:var(--font-size-11xl);font-weight:var(--font-weight-bold);color:var(--ion-white-color-text);margin:0 0 var(--spacing-md)}.brand-text[_ngcontent-%COMP%]{font-size:var(--font-size-xl);color:var(--ion-white-color-text);margin:0}.right-section[_ngcontent-%COMP%]{flex:1;display:flex;height:100vh;overflow:hidden}.scrollable-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:var(--spacing-lg);min-height:0}.form-container[_ngcontent-%COMP%]{max-width:400px;width:100%;margin:0 auto;min-height:calc(100vh - 2 * var(--spacing-lg));display:flex;flex-direction:column;justify-content:center}.logo-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-md);display:block}@media (min-width: 1024px){.logo-section[_ngcontent-%COMP%]{display:none}}.logo-circle[_ngcontent-%COMP%]{width:60px;height:60px;background:var(--ion-white-color-background);border-radius:var(--border-radius-lg);display:flex;align-items:center;justify-content:center;margin:0 auto var(--spacing-md);box-shadow:0 4px 16px #0000001a}.logo-icon[_ngcontent-%COMP%]{width:40px;height:40px}.app-title[_ngcontent-%COMP%]{font-size:var(--font-size-5xl);font-weight:var(--font-weight-bold);margin:0}.form-title[_ngcontent-%COMP%]{font-size:var(--font-size-5xl);font-weight:var(--font-weight-bold);margin:0 0 var(--spacing-xs);text-align:center}.form-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0 0 var(--spacing-xl);font-size:var(--font-size-base);text-align:center}.profile-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-md)}.image-upload-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-lg)}.avatar-container[_ngcontent-%COMP%]{display:inline-block;position:relative;cursor:pointer}.profile-avatar[_ngcontent-%COMP%]{width:80px;height:80px;border:2px solid var(--ion-color-primary)}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.camera-overlay[_ngcontent-%COMP%]{position:absolute;bottom:-2px;inset-inline-end:-2px;width:24px;height:24px;background:var(--ion-color-primary);border-radius:50%;display:flex;align-items:center;justify-content:center;border:2px solid var(--ion-background-color)}.camera-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-white-color-text);font-size:var(--font-size-sm)}.profile-floating-icons-left[_ngcontent-%COMP%]{position:absolute;top:18px;inset-inline-start:12px;z-index:999;color:var(--ion-text-color)}.date-input-wrapper[_ngcontent-%COMP%]{width:100%;position:relative}.date-input-wrapper[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{position:absolute;top:50%;inset-inline-start:46px;transform:translateY(-50%);font-size:var(--font-size-base);color:var(--ion-text-color);background:transparent;padding:0;transition:all .2s ease;pointer-events:none;z-index:1}.date-input-wrapper.has-focus[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.has-value[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{top:-8px;inset-inline-start:16px;transform:translateY(0);font-size:var(--font-size-sm);color:var(--ion-text-color);background:var(--ion-background-color);padding:0 4px;font-weight:var(--font-weight-medium)}.date-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:16px;padding-inline-start:46px!important;border:1.5px solid var(--ion-text-color);border-radius:8px;background:var(--ion-background-color);color:var(--ion-text-color);font-size:var(--font-size-base);cursor:pointer;box-sizing:border-box;transition:all .2s ease}.date-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.date-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:transparent}.date-input-wrapper.has-focus[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder, .date-input-wrapper.has-value[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--ion-color-medium)}.date-input-wrapper.ion-touched.ion-invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:var(--ion-color-danger)!important}.date-input-wrapper.ion-touched.ion-invalid.has-focus[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-invalid.has-value[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-invalid[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{color:var(--ion-color-danger)!important}.date-input-wrapper.ion-touched.ion-valid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:var(--ion-text-color)!important}.date-input-wrapper.ion-touched.ion-valid.has-focus[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-valid.has-value[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%], .date-input-wrapper.ion-touched.ion-valid[_ngcontent-%COMP%]   .floating-label[_ngcontent-%COMP%]{color:var(--ion-text-color)!important}.skip-section[_ngcontent-%COMP%]{text-align:center;margin-top:var(--spacing-md)}.skip-text[_ngcontent-%COMP%]{font-size:var(--font-size-md);margin:0}.skip-link[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:var(--font-weight-semibold);cursor:pointer;text-decoration:none}.skip-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.date-modal[_ngcontent-%COMP%]{padding:var(--spacing-lg)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-lg)}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:var(--font-size-xl);font-weight:var(--font-weight-semibold);margin:0}form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-width: 0;--inner-border-width: 0;--padding-start: 0;--padding-end: 0;--inner-padding-start: 0;--inner-padding-end: 0;overflow:visible!important;--background: none}form[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--border-color: var( --ion-text-color) !important;--border-width: 1.5px !important;--border-radius: 8px !important}form[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--border-color: var( --ion-text-color) !important;--border-width: 1.5px !important;--border-radius: 8px !important}ion-modal[_ngcontent-%COMP%]{--width: inherit;--min-width: inherit;--max-width: inherit;--height: inherit;--min-height: auto;--max-height: inherit}"]});let u=a;return u})();export{Fe as ProfileSetupPage};
